{"version":3,"file":"image-search.js","sources":["../src/js/search.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst API_KEY = '679609-0229bb159674f4386da445b6d';\nconst form = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loadMoreBtn = document.getElementById('load-more');\n\nlet currentQuery = '';\nlet page = 1;\nconst perPage = 40;\nlet totalHits = 0;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  currentQuery = event.target.search.value.trim();\n  if (!currentQuery) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search term!',\n    });\n    return;\n  }\n\n  page = 1;\n  gallery.innerHTML = '';\n  loadMoreBtn.style.display = 'none';\n\n  await searchImages(currentQuery);\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1;\n  await searchImages(currentQuery);\n});\n\nasync function searchImages(query) {\n  const url = `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(url);\n    const data = response.data;\n\n    if (data.hits.length === 0 && page === 1) {\n      iziToast.info({\n        title: 'Info',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    totalHits = data.totalHits;\n\n    displayImages(data.hits);\n\n    const totalLoaded = page * perPage;\n\n    if (totalLoaded >= totalHits) {\n      loadMoreBtn.style.display = 'none';\n      iziToast.info({\n        title: 'End of results',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      loadMoreBtn.style.display = 'block';\n    }\n\n    smoothScroll();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n    });\n    console.error('Error fetching images:', error);\n  }\n}\n\nfunction displayImages(images) {\n  const markup = images\n    .map(\n      image => `\n        <a href=\"${image.largeImageURL}\" class=\"image-card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          <div class=\"image-info\">\n            <p><strong>Likes:</strong> ${image.likes}</p>\n            <p><strong>Views:</strong> ${image.views}</p>\n            <p><strong>Comments:</strong> ${image.comments}</p>\n            <p><strong>Downloads:</strong> ${image.downloads}</p>\n          </div>\n        </a>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  const lightbox = new SimpleLightbox('.gallery a');\n  lightbox.refresh();\n}\n\nfunction smoothScroll() {\n  const firstGalleryItem = document.querySelector('.image-card');\n  if (firstGalleryItem) {\n    const itemHeight = firstGalleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: itemHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["API_KEY","form","gallery","loadMoreBtn","currentQuery","page","perPage","totalHits","event","iziToast","searchImages","query","url","data","axios","displayImages","smoothScroll","error","images","markup","image","SimpleLightbox","firstGalleryItem","itemHeight"],"mappings":"sJAMA,MAAMA,EAAU,mCACVC,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAc,SAAS,eAAe,WAAW,EAEvD,IAAIC,EAAe,GACfC,EAAO,EACX,MAAMC,EAAU,GAChB,IAAIC,EAAY,EAEhBN,EAAK,iBAAiB,SAAU,MAAMO,GAAS,CAI7C,GAHAA,EAAM,eAAc,EAEpBJ,EAAeI,EAAM,OAAO,OAAO,MAAM,KAAI,EACzC,CAACJ,EAAc,CACjBK,EAAS,MAAM,CACb,MAAO,QACP,QAAS,6BACf,CAAK,EACD,MACD,CAEDJ,EAAO,EACPH,EAAQ,UAAY,GACpBC,EAAY,MAAM,QAAU,OAE5B,MAAMO,EAAaN,CAAY,CACjC,CAAC,EAEDD,EAAY,iBAAiB,QAAS,SAAY,CAChDE,GAAQ,EACR,MAAMK,EAAaN,CAAY,CACjC,CAAC,EAED,eAAeM,EAAaC,EAAO,CACjC,MAAMC,EAAM,gCAAgCZ,CAAO,MAAM,mBACvDW,CACD,CAAA,iEAAiEN,CAAI,aAAaC,CAAO,GAE1F,GAAI,CAEF,MAAMO,GADW,MAAMC,EAAM,IAAIF,CAAG,GACd,KAEtB,GAAIC,EAAK,KAAK,SAAW,GAAKR,IAAS,EAAG,CACxCI,EAAS,KAAK,CACZ,MAAO,OACP,QACE,0EACV,CAAO,EACD,MACD,CAEDF,EAAYM,EAAK,UAEjBE,EAAcF,EAAK,IAAI,EAEHR,EAAOC,GAERC,GACjBJ,EAAY,MAAM,QAAU,OAC5BM,EAAS,KAAK,CACZ,MAAO,iBACP,QAAS,4DACjB,CAAO,GAEDN,EAAY,MAAM,QAAU,QAG9Ba,GACD,OAAQC,EAAO,CACdR,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+CACf,CAAK,EACD,QAAQ,MAAM,yBAA0BQ,CAAK,CAC9C,CACH,CAEA,SAASF,EAAcG,EAAQ,CAC7B,MAAMC,EAASD,EACZ,IACCE,GAAS;AAAA,mBACIA,EAAM,aAAa;AAAA,sBAChBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,yCAEnBA,EAAM,KAAK;AAAA,yCACXA,EAAM,KAAK;AAAA,4CACRA,EAAM,QAAQ;AAAA,6CACbA,EAAM,SAAS;AAAA;AAAA,aAGvD,EACA,KAAK,EAAE,EAEVlB,EAAQ,mBAAmB,YAAaiB,CAAM,EAE7B,IAAIE,EAAe,YAAY,EACvC,QAAO,CAClB,CAEA,SAASL,GAAe,CACtB,MAAMM,EAAmB,SAAS,cAAc,aAAa,EAC7D,GAAIA,EAAkB,CACpB,MAAMC,EAAaD,EAAiB,sBAAqB,EAAG,OAC5D,OAAO,SAAS,CACd,IAAKC,EAAa,EAClB,SAAU,QAChB,CAAK,CACF,CACH"}