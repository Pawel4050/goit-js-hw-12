{"version":3,"file":"image-search.js","sources":["../src/js/search.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst API_KEY = '679609-0229bb159674f4386da445b6d';\nconst form = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loadMoreBtn = document.getElementById('load-more');\nconst loader = document.getElementById('loader');\n\nlet currentPage = 1; // Zmienna globalna dla paginacji\nlet totalHits = 0; // Zmienna do przechowywania liczby wszystkich dostępnych obrazów\nlet query = ''; // Globalna zmienna przechowująca aktualne zapytanie\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n\n  query = event.target.search.value.trim();\n  if (!query) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search term!',\n    });\n    return;\n  }\n\n  gallery.innerHTML = ''; // Wyczyść galerię dla nowego zapytania\n  loadMoreBtn.style.display = 'none'; // Ukryj przycisk na początku wyszukiwania\n  currentPage = 1; // Resetuj paginację dla nowego zapytania\n  searchImages(query);\n});\n\nloadMoreBtn.addEventListener('click', () => {\n  currentPage++; // Zwiększ stronę, aby załadować więcej obrazów\n  searchImages(query);\n});\n\nasync function searchImages(query) {\n  const url = `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=40`;\n\n  try {\n    loader.style.display = 'block'; // Pokaż loader\n    const response = await axios.get(url);\n    const data = response.data;\n\n    if (currentPage === 1) {\n      totalHits = data.totalHits; // Przechowaj całkowitą liczbę obrazów\n      if (totalHits === 0) {\n        iziToast.info({\n          title: 'Info',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n        gallery.innerHTML = '';\n        return;\n      }\n    }\n\n    displayImages(data.hits);\n\n    if (gallery.children.length >= totalHits) {\n      // Jeśli osiągnięto koniec zbioru\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      loadMoreBtn.style.display = 'none'; // Ukryj przycisk \"Load more\"\n    } else {\n      loadMoreBtn.style.display = 'block'; // Pokaż przycisk \"Load more\"\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again later.',\n    });\n    console.error('Error fetching images:', error);\n  } finally {\n    loader.style.display = 'none'; // Ukryj loader po zakończeniu żądania\n  }\n}\n\nfunction displayImages(images) {\n  const markup = images\n    .map(\n      image => `\n        <a href=\"${image.largeImageURL}\" class=\"image-card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          <div class=\"image-info\">\n            <p><strong>Likes:</strong> ${image.likes}</p>\n            <p><strong>Views:</strong> ${image.views}</p>\n            <p><strong>Comments:</strong> ${image.comments}</p>\n            <p><strong>Downloads:</strong> ${image.downloads}</p>\n          </div>\n        </a>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup); // Dodaj obrazy do galerii\n  const lightbox = new SimpleLightbox('.gallery a');\n  lightbox.refresh();\n}\n"],"names":["API_KEY","form","gallery","loadMoreBtn","loader","currentPage","totalHits","query","event","iziToast","searchImages","url","data","axios","displayImages","error","images","markup","image","SimpleLightbox"],"mappings":"sJAQA,MAAMA,EAAU,mCACVC,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAc,SAAS,eAAe,WAAW,EACjDC,EAAS,SAAS,eAAe,QAAQ,EAE/C,IAAIC,EAAc,EACdC,EAAY,EACZC,EAAQ,GAEZN,EAAK,iBAAiB,SAAUO,GAAS,CAIvC,GAHAA,EAAM,eAAc,EAEpBD,EAAQC,EAAM,OAAO,OAAO,MAAM,KAAI,EAClC,CAACD,EAAO,CACVE,EAAS,MAAM,CACb,MAAO,QACP,QAAS,6BACf,CAAK,EACD,MACD,CAEDP,EAAQ,UAAY,GACpBC,EAAY,MAAM,QAAU,OAC5BE,EAAc,EACdK,EAAaH,CAAK,CACpB,CAAC,EAEDJ,EAAY,iBAAiB,QAAS,IAAM,CAC1CE,IACAK,EAAaH,CAAK,CACpB,CAAC,EAED,eAAeG,EAAaH,EAAO,CACjC,MAAMI,EAAM,gCAAgCX,CAAO,MAAM,mBACvDO,CACJ,CAAG,iEAAiEF,CAAW,eAE7E,GAAI,CACFD,EAAO,MAAM,QAAU,QAEvB,MAAMQ,GADW,MAAMC,EAAM,IAAIF,CAAG,GACd,KAEtB,GAAIN,IAAgB,IAClBC,EAAYM,EAAK,UACbN,IAAc,GAAG,CACnBG,EAAS,KAAK,CACZ,MAAO,OACP,QACE,0EACZ,CAAS,EACDP,EAAQ,UAAY,GACpB,MACD,CAGHY,EAAcF,EAAK,IAAI,EAEnBV,EAAQ,SAAS,QAAUI,GAE7BG,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,4DACjB,CAAO,EACDN,EAAY,MAAM,QAAU,QAE5BA,EAAY,MAAM,QAAU,OAE/B,OAAQY,EAAO,CACdN,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+CACf,CAAK,EACD,QAAQ,MAAM,yBAA0BM,CAAK,CACjD,QAAY,CACRX,EAAO,MAAM,QAAU,MACxB,CACH,CAEA,SAASU,EAAcE,EAAQ,CAC7B,MAAMC,EAASD,EACZ,IACCE,GAAS;AAAA,mBACIA,EAAM,aAAa;AAAA,sBAChBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,yCAEnBA,EAAM,KAAK;AAAA,yCACXA,EAAM,KAAK;AAAA,4CACRA,EAAM,QAAQ;AAAA,6CACbA,EAAM,SAAS;AAAA;AAAA,aAGvD,EACA,KAAK,EAAE,EAEVhB,EAAQ,mBAAmB,YAAae,CAAM,EAC7B,IAAIE,EAAe,YAAY,EACvC,QAAO,CAClB"}